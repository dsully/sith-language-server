---
source: crates/sith_python_parser/src/parser/tests/parser.rs
expression: "parse(r#\"\nf\"normal {foo} {{another}} {bar} {{{three}}}\"\nf\"normal {foo!a} {bar!s} {baz!r} {foobar}\"\nf\"normal {x:y + 2}\"\nf\"{x:{{1}.pop()}}\"\nf\"{(lambda x:{x})}\"\nf\"{x =}\"\nf\"{    x = }\"\nf\"{x=!a}\"\nf\"{x:.3f!r =}\"\nf\"{x = !r :.3f}\"\nf\"{x:.3f=!r}\"\n\"hello\" f\"{x}\"\nf\"{x}\" f\"{y}\"\nf\"{x}\" \"world\"\nf\"Invalid args in command: {command, *args}\"\n\"foo\" f\"{x}\" \"bar\"\n(\n    f\"a\"\n    F\"b\"\n    \"c\"\n    rf\"d\"\n    fr\"e\"\n)\n\"#)"
---
ParsedFile {
    ast: Module(
        ModModule {
            range: 0..386,
            body: [
                Expr(
                    ExprStmt {
                        range: 1..46,
                        value: FString(
                            FStringExpr {
                                range: 1..46,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 1..46,
                                                elements: [
                                                    Literal(
                                                        FStringLiteralElement {
                                                            range: 3..10,
                                                            value: "normal ",
                                                        },
                                                    ),
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 10..15,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 11..14,
                                                                    id: "foo",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: None,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                    Literal(
                                                        FStringLiteralElement {
                                                            range: 15..28,
                                                            value: " {another} ",
                                                        },
                                                    ),
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 28..33,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 29..32,
                                                                    id: "bar",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: None,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                    Literal(
                                                        FStringLiteralElement {
                                                            range: 33..36,
                                                            value: " {",
                                                        },
                                                    ),
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 36..43,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 37..42,
                                                                    id: "three",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: None,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                    Literal(
                                                        FStringLiteralElement {
                                                            range: 43..45,
                                                            value: "}",
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 47..89,
                        value: FString(
                            FStringExpr {
                                range: 47..89,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 47..89,
                                                elements: [
                                                    Literal(
                                                        FStringLiteralElement {
                                                            range: 49..56,
                                                            value: "normal ",
                                                        },
                                                    ),
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 56..63,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 57..60,
                                                                    id: "foo",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: Ascii,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                    Literal(
                                                        FStringLiteralElement {
                                                            range: 63..64,
                                                            value: " ",
                                                        },
                                                    ),
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 64..71,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 65..68,
                                                                    id: "bar",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: Str,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                    Literal(
                                                        FStringLiteralElement {
                                                            range: 71..72,
                                                            value: " ",
                                                        },
                                                    ),
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 72..79,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 73..76,
                                                                    id: "baz",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: Repr,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                    Literal(
                                                        FStringLiteralElement {
                                                            range: 79..80,
                                                            value: " ",
                                                        },
                                                    ),
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 80..88,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 81..87,
                                                                    id: "foobar",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: None,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 90..109,
                        value: FString(
                            FStringExpr {
                                range: 90..109,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 90..109,
                                                elements: [
                                                    Literal(
                                                        FStringLiteralElement {
                                                            range: 92..99,
                                                            value: "normal ",
                                                        },
                                                    ),
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 99..108,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 100..101,
                                                                    id: "x",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: None,
                                                            format_spec: Some(
                                                                FStringFormatSpec {
                                                                    range: 102..107,
                                                                    elements: [
                                                                        Literal(
                                                                            FStringLiteralElement {
                                                                                range: 102..107,
                                                                                value: "y + 2",
                                                                            },
                                                                        ),
                                                                    ],
                                                                },
                                                            ),
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 110..128,
                        value: FString(
                            FStringExpr {
                                range: 110..128,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 110..128,
                                                elements: [
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 112..127,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 113..114,
                                                                    id: "x",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: None,
                                                            format_spec: Some(
                                                                FStringFormatSpec {
                                                                    range: 115..126,
                                                                    elements: [
                                                                        Expression(
                                                                            FStringExpressionElement {
                                                                                range: 115..126,
                                                                                expression: Call(
                                                                                    CallExpr {
                                                                                        range: 116..125,
                                                                                        func: Attribute(
                                                                                            AttributeExpr {
                                                                                                range: 116..123,
                                                                                                value: Set(
                                                                                                    SetExpr {
                                                                                                        range: 116..119,
                                                                                                        elts: [
                                                                                                            NumberLiteral(
                                                                                                                NumberLiteralExpr {
                                                                                                                    range: 117..118,
                                                                                                                    value: Int(
                                                                                                                        1,
                                                                                                                    ),
                                                                                                                },
                                                                                                            ),
                                                                                                        ],
                                                                                                    },
                                                                                                ),
                                                                                                attr: Identifier {
                                                                                                    id: "pop",
                                                                                                    range: 120..123,
                                                                                                },
                                                                                                ctx: Load,
                                                                                            },
                                                                                        ),
                                                                                        arguments: Arguments {
                                                                                            range: 123..125,
                                                                                            args: [],
                                                                                            keywords: [],
                                                                                        },
                                                                                    },
                                                                                ),
                                                                                debug_text: None,
                                                                                conversion: None,
                                                                                format_spec: None,
                                                                            },
                                                                        ),
                                                                    ],
                                                                },
                                                            ),
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 129..148,
                        value: FString(
                            FStringExpr {
                                range: 129..148,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 129..148,
                                                elements: [
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 131..147,
                                                            expression: Lambda(
                                                                LambdaExpr {
                                                                    range: 133..145,
                                                                    parameters: Some(
                                                                        Parameters {
                                                                            range: 140..141,
                                                                            posonlyargs: [],
                                                                            args: [
                                                                                ParameterWithDefault {
                                                                                    range: 140..141,
                                                                                    parameter: Parameter {
                                                                                        range: 140..141,
                                                                                        name: Identifier {
                                                                                            id: "x",
                                                                                            range: 140..141,
                                                                                        },
                                                                                        annotation: None,
                                                                                    },
                                                                                    default: None,
                                                                                },
                                                                            ],
                                                                            vararg: None,
                                                                            kwonlyargs: [],
                                                                            kwarg: None,
                                                                        },
                                                                    ),
                                                                    body: Set(
                                                                        SetExpr {
                                                                            range: 142..145,
                                                                            elts: [
                                                                                Name(
                                                                                    NameExpr {
                                                                                        range: 143..144,
                                                                                        id: "x",
                                                                                        ctx: Load,
                                                                                    },
                                                                                ),
                                                                            ],
                                                                        },
                                                                    ),
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: None,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 149..157,
                        value: FString(
                            FStringExpr {
                                range: 149..157,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 149..157,
                                                elements: [
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 151..156,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 152..153,
                                                                    id: "x",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: Some(
                                                                DebugText {
                                                                    leading: "",
                                                                    trailing: " =",
                                                                },
                                                            ),
                                                            conversion: None,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 158..171,
                        value: FString(
                            FStringExpr {
                                range: 158..171,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 158..171,
                                                elements: [
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 160..170,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 165..166,
                                                                    id: "x",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: Some(
                                                                DebugText {
                                                                    leading: "    ",
                                                                    trailing: " = ",
                                                                },
                                                            ),
                                                            conversion: None,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 172..181,
                        value: FString(
                            FStringExpr {
                                range: 172..181,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 172..181,
                                                elements: [
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 174..180,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 175..176,
                                                                    id: "x",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: Some(
                                                                DebugText {
                                                                    leading: "",
                                                                    trailing: "=",
                                                                },
                                                            ),
                                                            conversion: Ascii,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 182..196,
                        value: FString(
                            FStringExpr {
                                range: 182..196,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 182..196,
                                                elements: [
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 184..195,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 185..186,
                                                                    id: "x",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: None,
                                                            format_spec: Some(
                                                                FStringFormatSpec {
                                                                    range: 187..194,
                                                                    elements: [
                                                                        Literal(
                                                                            FStringLiteralElement {
                                                                                range: 187..194,
                                                                                value: ".3f!r =",
                                                                            },
                                                                        ),
                                                                    ],
                                                                },
                                                            ),
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 197..213,
                        value: FString(
                            FStringExpr {
                                range: 197..213,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 197..213,
                                                elements: [
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 199..212,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 200..201,
                                                                    id: "x",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: Some(
                                                                DebugText {
                                                                    leading: "",
                                                                    trailing: " = ",
                                                                },
                                                            ),
                                                            conversion: Repr,
                                                            format_spec: Some(
                                                                FStringFormatSpec {
                                                                    range: 208..211,
                                                                    elements: [
                                                                        Literal(
                                                                            FStringLiteralElement {
                                                                                range: 208..211,
                                                                                value: ".3f",
                                                                            },
                                                                        ),
                                                                    ],
                                                                },
                                                            ),
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 214..227,
                        value: FString(
                            FStringExpr {
                                range: 214..227,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 214..227,
                                                elements: [
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 216..226,
                                                            expression: Name(
                                                                NameExpr {
                                                                    range: 217..218,
                                                                    id: "x",
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: None,
                                                            format_spec: Some(
                                                                FStringFormatSpec {
                                                                    range: 219..225,
                                                                    elements: [
                                                                        Literal(
                                                                            FStringLiteralElement {
                                                                                range: 219..225,
                                                                                value: ".3f=!r",
                                                                            },
                                                                        ),
                                                                    ],
                                                                },
                                                            ),
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 228..242,
                        value: FString(
                            FStringExpr {
                                range: 228..242,
                                value: FStringValue {
                                    inner: Concatenated(
                                        [
                                            Literal(
                                                StringLiteral {
                                                    range: 228..235,
                                                    value: "hello",
                                                    unicode: false,
                                                },
                                            ),
                                            FString(
                                                FString {
                                                    range: 236..242,
                                                    elements: [
                                                        Expression(
                                                            FStringExpressionElement {
                                                                range: 238..241,
                                                                expression: Name(
                                                                    NameExpr {
                                                                        range: 239..240,
                                                                        id: "x",
                                                                        ctx: Load,
                                                                    },
                                                                ),
                                                                debug_text: None,
                                                                conversion: None,
                                                                format_spec: None,
                                                            },
                                                        ),
                                                    ],
                                                },
                                            ),
                                        ],
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 243..256,
                        value: FString(
                            FStringExpr {
                                range: 243..256,
                                value: FStringValue {
                                    inner: Concatenated(
                                        [
                                            FString(
                                                FString {
                                                    range: 243..249,
                                                    elements: [
                                                        Expression(
                                                            FStringExpressionElement {
                                                                range: 245..248,
                                                                expression: Name(
                                                                    NameExpr {
                                                                        range: 246..247,
                                                                        id: "x",
                                                                        ctx: Load,
                                                                    },
                                                                ),
                                                                debug_text: None,
                                                                conversion: None,
                                                                format_spec: None,
                                                            },
                                                        ),
                                                    ],
                                                },
                                            ),
                                            FString(
                                                FString {
                                                    range: 250..256,
                                                    elements: [
                                                        Expression(
                                                            FStringExpressionElement {
                                                                range: 252..255,
                                                                expression: Name(
                                                                    NameExpr {
                                                                        range: 253..254,
                                                                        id: "y",
                                                                        ctx: Load,
                                                                    },
                                                                ),
                                                                debug_text: None,
                                                                conversion: None,
                                                                format_spec: None,
                                                            },
                                                        ),
                                                    ],
                                                },
                                            ),
                                        ],
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 257..271,
                        value: FString(
                            FStringExpr {
                                range: 257..271,
                                value: FStringValue {
                                    inner: Concatenated(
                                        [
                                            FString(
                                                FString {
                                                    range: 257..263,
                                                    elements: [
                                                        Expression(
                                                            FStringExpressionElement {
                                                                range: 259..262,
                                                                expression: Name(
                                                                    NameExpr {
                                                                        range: 260..261,
                                                                        id: "x",
                                                                        ctx: Load,
                                                                    },
                                                                ),
                                                                debug_text: None,
                                                                conversion: None,
                                                                format_spec: None,
                                                            },
                                                        ),
                                                    ],
                                                },
                                            ),
                                            Literal(
                                                StringLiteral {
                                                    range: 264..271,
                                                    value: "world",
                                                    unicode: false,
                                                },
                                            ),
                                        ],
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 272..316,
                        value: FString(
                            FStringExpr {
                                range: 272..316,
                                value: FStringValue {
                                    inner: Single(
                                        FString(
                                            FString {
                                                range: 272..316,
                                                elements: [
                                                    Literal(
                                                        FStringLiteralElement {
                                                            range: 274..299,
                                                            value: "Invalid args in command: ",
                                                        },
                                                    ),
                                                    Expression(
                                                        FStringExpressionElement {
                                                            range: 299..315,
                                                            expression: Tuple(
                                                                TupleExpr {
                                                                    range: 300..314,
                                                                    elts: [
                                                                        Name(
                                                                            NameExpr {
                                                                                range: 300..307,
                                                                                id: "command",
                                                                                ctx: Load,
                                                                            },
                                                                        ),
                                                                        Starred(
                                                                            StarredExpr {
                                                                                range: 309..314,
                                                                                value: Name(
                                                                                    NameExpr {
                                                                                        range: 310..314,
                                                                                        id: "args",
                                                                                        ctx: Load,
                                                                                    },
                                                                                ),
                                                                                ctx: Load,
                                                                            },
                                                                        ),
                                                                    ],
                                                                    ctx: Load,
                                                                },
                                                            ),
                                                            debug_text: None,
                                                            conversion: None,
                                                            format_spec: None,
                                                        },
                                                    ),
                                                ],
                                            },
                                        ),
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 317..335,
                        value: FString(
                            FStringExpr {
                                range: 317..335,
                                value: FStringValue {
                                    inner: Concatenated(
                                        [
                                            Literal(
                                                StringLiteral {
                                                    range: 317..322,
                                                    value: "foo",
                                                    unicode: false,
                                                },
                                            ),
                                            FString(
                                                FString {
                                                    range: 323..329,
                                                    elements: [
                                                        Expression(
                                                            FStringExpressionElement {
                                                                range: 325..328,
                                                                expression: Name(
                                                                    NameExpr {
                                                                        range: 326..327,
                                                                        id: "x",
                                                                        ctx: Load,
                                                                    },
                                                                ),
                                                                debug_text: None,
                                                                conversion: None,
                                                                format_spec: None,
                                                            },
                                                        ),
                                                    ],
                                                },
                                            ),
                                            Literal(
                                                StringLiteral {
                                                    range: 330..335,
                                                    value: "bar",
                                                    unicode: false,
                                                },
                                            ),
                                        ],
                                    ),
                                },
                            },
                        ),
                    },
                ),
                Expr(
                    ExprStmt {
                        range: 336..385,
                        value: FString(
                            FStringExpr {
                                range: 342..383,
                                value: FStringValue {
                                    inner: Concatenated(
                                        [
                                            FString(
                                                FString {
                                                    range: 342..346,
                                                    elements: [
                                                        Literal(
                                                            FStringLiteralElement {
                                                                range: 344..345,
                                                                value: "a",
                                                            },
                                                        ),
                                                    ],
                                                },
                                            ),
                                            FString(
                                                FString {
                                                    range: 351..355,
                                                    elements: [
                                                        Literal(
                                                            FStringLiteralElement {
                                                                range: 353..354,
                                                                value: "b",
                                                            },
                                                        ),
                                                    ],
                                                },
                                            ),
                                            Literal(
                                                StringLiteral {
                                                    range: 360..363,
                                                    value: "c",
                                                    unicode: false,
                                                },
                                            ),
                                            FString(
                                                FString {
                                                    range: 368..373,
                                                    elements: [
                                                        Literal(
                                                            FStringLiteralElement {
                                                                range: 371..372,
                                                                value: "d",
                                                            },
                                                        ),
                                                    ],
                                                },
                                            ),
                                            FString(
                                                FString {
                                                    range: 378..383,
                                                    elements: [
                                                        Literal(
                                                            FStringLiteralElement {
                                                                range: 381..382,
                                                                value: "e",
                                                            },
                                                        ),
                                                    ],
                                                },
                                            ),
                                        ],
                                    ),
                                },
                            },
                        ),
                    },
                ),
            ],
        },
    ),
    parse_errors: [],
}
